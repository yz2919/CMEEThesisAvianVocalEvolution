View(dataset)
pdf(file="../data/Territoriality.pdf",width=7,height=7)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_territory, xlab="",ylab="Aves PC1", names=c("Weak", "Strong"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC1",names=c("Weak", "Strong"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_territory, xlab="", ylab="Aves PC2", names=c("Weak", "Strong"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC2", names=c("Weak", "Strong"),col="tomato4")
mtext(text="Territoriality",side=1,line=0,outer=TRUE)
dev.off()
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
pdf(file="../data/Mating.pdf",width=7,height=7)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
dev.off()
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2*", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2*", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2 *", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2*", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
pdf(file="../data/Mating.pdf",width=7,height=7)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2 *", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2 *", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
dev.off()
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_habitat, xlab="",ylab="Aves PC1", names=c("Open", "Closed"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC1",names=c("Open", "Closed"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_habitat, xlab="", ylab="Aves PC2 *", names=c("Open", "Closed"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC2 *", names=c("Open", "Closed"),col="tomato4")
mtext(text="Habitat",side=1,line=0,outer=TRUE)
pdf(file="../data/Habitat.pdf",width=7,height=7)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_habitat, xlab="",ylab="Aves PC1", names=c("Open", "Closed"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC1",names=c("Open", "Closed"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_habitat, xlab="", ylab="Aves PC2 *", names=c("Open", "Closed"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC2 *", names=c("Open", "Closed"),col="tomato4")
mtext(text="Habitat",side=1,line=0,outer=TRUE)
dev.off()
# b10k<-read_xlsx("../data/b10k.xlsx")
b10k<-read.csv("../data/b10kb.csv")
avgpasser <- read_xlsx("../data/avgpassertree.xlsx",1)
pPCAScores_passer<-read.csv("../data/pPCAScores_passer.csv")
pPCAScores_SC_passer<-read.csv("../data/pPCAScores_SC_passer.csv")
avgpasser$Family <- str_extract_all(avgpasser$HM4.Family, "^\\w+")
avgpasser$Family <- gsub(' [A-z ]*', '' , avgpasser$Family)
length(unique(avgpasser$Family))
length(unique(avgpasser$HM4.Order))
###Load tree
MyTree=read.nexus("../data/output.nex")
tree.consensus = consensus(MyTree, p = 0.5)
MyTree.1 = compute.brlen(tree.consensus, 1)
#delete species without acoustic data
b10k$scientific <- gsub(" ","_",b10k$scientific)
avgpasser$scientific <- gsub(" ","_",avgpasser$scientific)
b10k_pa<-b10k[match(avgpasser$scientific,b10k$scientific),]
# sum(is.na(b10k$scientific))
# check tip lable match b10k trait
# tree$tip.label[!(tree$tip.label %in% b10k$scientific)]
# select specific columns trait
b10k_pa <- as.data.frame(b10k_pa)
b10k_pa<- subset(b10k_pa, select = -c(b10k.m_mass, b10k.unsexed_mass, b10k.s_bond_stab, b10k.territory) )
# pick b10k trait with score
b10k_passer <- b10k_pa[match(pPCAScores_passer$X, b10k_pa$scientific),]
b10k_SC_passer <- b10k_pa[match(pPCAScores_SC_passer$X, b10k_pa$scientific),]
select_trait_passer<-data.frame(pPCAScores_passer,b10k_passer)
select_trait_SC_passer <-data.frame(pPCAScores_SC_passer,b10k_SC_passer)
#drop na in scientific name
select_trait_passer<-select_trait_passer %>% drop_na("scientific")
select_trait_SC_passer<-select_trait_SC_passer %>% drop_na("scientific")
dataset_passer <- comparative.data(data=select_trait_passer,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
dataset_SC_passer <- comparative.data(data=select_trait_SC_passer,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
##additive models outline
#8 metric
passer1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset_passer,lambda= "ML")
summary(passer1)
AIC(Model1)
BIC(Model1)
#8 metric
passer2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(passer2)
AIC(Model2)
BIC(Model2)
##additive models outline
#8 metric
Model1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model1)
AIC(Model1)
#8 metric
Model2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model2)
AIC(Model2)
View(select_trait_AC)
View(select_trait_passer)
b10k<-read_xlsx("../data/b10k.xlsx")
model.traits.b10k <- b10k
table(b10k$b10k.habitat)
index3 <- model.traits.b10k$b10k.habitat != 3
model.traits.b10k$binary_habitat <- model.traits.b10k$b10k.habitat
model.traits.b10k$binary_habitat[index3] = 1
table(b10k$b10k.unidirectional)
index4 <- model.traits.b10k$b10k.unidirectional != 0
model.traits.b10k$binary_unidirectional <- model.traits.b10k$b10k.unidirectional
model.traits.b10k$binary_unidirectional[index4] = 3
table(b10k$territory)
index2 <- model.traits.b10k$territory != 3
model.traits.b10k$binary_territory <- model.traits.b10k$territory
model.traits.b10k$binary_territory[index2] = 1
table(b10k$s_bond_stab)
index1 <- model.traits.b10k$s_bond_stab != 3
model.traits.b10k$binary_s_bond_stab <- model.traits.b10k$s_bond_stab
model.traits.b10k$binary_s_bond_stab[index1] = 1
table(b10k$b10k.migration)
index5 <- model.traits.b10k$b10k.migration != 1
model.traits.b10k$binary_migration <- model.traits.b10k$b10k.migration
model.traits.b10k$binary_migration[index5] = 3
# log transform mass and bill traits
model.traits.b10k$b10k.mass <- log(model.traits.b10k$b10k.mass)
hist(model.traits.b10k$b10k.mass)
model.traits.b10k$b10k.bill_nares <- log(model.traits.b10k$b10k.bill_nares)
hist(model.traits.b10k$b10k.bill_nares)
write.csv(model.traits.b10k,"../data/b10kb.csv")
# b10k<-read_xlsx("../data/b10k.xlsx")
b10k<-read.csv("../data/b10kb.csv")
avgsong <- read_xlsx("../data/avgsongtree.xlsx",1)
pPCAScores_song_2<-read.csv("../data/pPCAScores_8.csv")
pPCAScores_SC<-read.csv("../data/pPCAScores_SC.csv")
#delete species without acoustic data
b10k$scientific <- gsub(" ","_",b10k$scientific)
avgsong$scientific <- gsub(" ","_",avgsong$scientific)
b10k<-b10k[match(avgsong$scientific,b10k$scientific),]
# sum(is.na(b10k$scientific))
# check tip lable match b10k trait
# tree$tip.label[!(tree$tip.label %in% b10k$scientific)]
# select specific columns trait
b10k <- as.data.frame(b10k)
b10k<- subset(b10k, select = -c(b10k.m_mass, b10k.unsexed_mass, b10k.s_bond_stab, b10k.territory) )
# pick b10k trait with score
b10k_AC <- b10k[match(pPCAScores_song_2$X, b10k$scientific),]
b10k_SC <- b10k[match(pPCAScores_SC$X, b10k$scientific),]
select_trait <-data.frame(pPCAScores_song_2,b10k_AC)
# select_trait <- select_trait[match(pPCAScores_song_2$X, b10k_AC$scientific),]
select_trait_SC <-data.frame(pPCAScores_SC,b10k_SC)
#drop na in scientific name
select_trait_AC<-select_trait %>% drop_na("scientific")
select_trait_SC<-select_trait_SC %>% drop_na("scientific")
avgpasser <- read_xlsx("../data/avgpassertree.xlsx",1)
avgpasser$Family <- str_extract_all(avgpasser$HM4.Family, "^\\w+")
#delete species without acoustic data
b10k$scientific <- gsub(" ","_",b10k$scientific)
avgpasser$scientific <- gsub(" ","_",avgpasser$scientific)
b10k_pa<-b10k[match(avgpasser$scientific,b10k$scientific),]
# sum(is.na(b10k$scientific))
# check tip lable match b10k trait
# tree$tip.label[!(tree$tip.label %in% b10k$scientific)]
# select specific columns trait
b10k_pa <- as.data.frame(b10k_pa)
b10k_pa<- subset(b10k_pa, select = -c(b10k.m_mass, b10k.unsexed_mass, b10k.s_bond_stab, b10k.territory) )
# pick b10k trait with score
b10k_passer <- b10k_pa[match(pPCAScores_passer$X, b10k_pa$scientific),]
b10k_SC_passer <- b10k_pa[match(pPCAScores_SC_passer$X, b10k_pa$scientific),]
select_trait_passer<-data.frame(pPCAScores_passer,b10k_passer)
select_trait_SC_passer <-data.frame(pPCAScores_SC_passer,b10k_SC_passer)
#drop na in scientific name
select_trait_passer<-select_trait_passer %>% drop_na("scientific")
select_trait_SC_passer<-select_trait_SC_passer %>% drop_na("scientific")
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_habitat, xlab="",ylab="Aves PC1", names=c("Open", "Closed"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC1",names=c("Open", "Closed"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_habitat, xlab="", ylab="Aves PC2 *", names=c("Open", "Closed"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC2 *", names=c("Open", "Closed"),col="tomato4")
mtext(text="Habitat",side=1,line=0,outer=TRUE)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_habitat, xlab="",ylab="Aves PC1",  col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC1",col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_habitat, xlab="", ylab="Aves PC2 *",col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC2 *", col="tomato4")
mtext(text="Habitat",side=1,line=0,outer=TRUE)
pdf(file="../data/Morphology.pdf",width=7,height=4)
par(mfrow=c(2,4),mar=c(2, 2, 2, 2),oma = c(2, 0, 0.2, 0))
par(mai=c(0.5,0.7,0.2,0))
plot(PC1~b10k.mass, data = select_trait_AC, xlab="", ylab = "Aves Vocalisation PC1 *",pch=20, col="steelblue4")
abline(massPC1)
par(mai=c(0.5,0.4,0.2,0.3))
plot(PC1~bill_PC1, data = select_trait_AC, xlab="", ylab = "",pch=20, col="tomato4")
abline(billPC1)
par(mai=c(0.5,0.6,0.2,0.1))
plot(PC2~b10k.mass, data = select_trait_AC, xlab="", ylab = "Aves Vocalisation PC2",pch=20,col="steelblue4")
abline(massPC2)
par(mai=c(0.5,0.3,0.2,0.4))
plot(PC2~bill_PC1, data = select_trait_AC, xlab="", ylab = "",pch=20, col="tomato4")
abline(bilPC2)
par(mai=c(0.7,0.7,0,0))
plot(PC1~b10k.mass, data = select_trait_passer, xlab="log(Body Mass)", ylab = "Passerines Song PC1",pch=20,col="steelblue4")
abline(pasPC1mass1)
par(mai=c(0.7,0.4,0,0.3))
plot(PC1~bill_PC1, data = select_trait_passer, xlab="Bill PC1", ylab = "PC1",pch=16,col="tomato4")
abline(pasbillPC1)
par(mai=c(0.7,0.6,0,0.1))
plot(PC2~b10k.mass, data = select_trait_passer, xlab="log(Body Mass)", ylab = "Passerines Song PC2",pch=20,col="steelblue4")
abline(pasPC2mass1)
par(mai=c(0.7,0.3,0,0.4))
plot(PC2~bill_PC1, data = select_trait_passer, xlab="Bill PC1", ylab = "Passerines Song PC2 *",pch=16,col="tomato4")
abline(pasbillPC2)
mtext(text="Morphology",side=1,line=0,outer=TRUE)
dev.off()
pdf(file="../data/Territoriality.pdf",width=7,height=7)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_territory, xlab="",ylab="Aves PC1 *", names=c("Weak", "Strong"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC1 *",names=c("Weak", "Strong"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_territory, xlab="", ylab="Aves PC2 *", names=c("Weak", "Strong"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC2 *", names=c("Weak", "Strong"),col="tomato4")
mtext(text="Territoriality",side=1,line=0,outer=TRUE)
dev.off()
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2 *", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2 *", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
pdf(file="../data/Mating.pdf",width=6,height=6)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2 *", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2 *", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
dev.off()
pdf(file="../data/Mating.pdf",width=6,height=5)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_unidirectional, xlab="",ylab="Aves PC1", names=c("Monogamous", "Polygamous"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC1",names=c("Monogamous", "Polygamous"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_unidirectional, xlab="", ylab="Aves PC2 *", names=c("Monogamous", "Polygamous"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_unidirectional, xlab="", ylab="Passerines PC2 *", names=c("Monogamous", "Polygamous"),col="tomato4")
mtext(text="Mating system",side=1,line=0,outer=TRUE)
dev.off()
pdf(file="../data/Territoriality.pdf",width=6,height=5)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_territory, xlab="",ylab="Aves PC1 *", names=c("Weak", "Strong"), col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC1 *",names=c("Weak", "Strong"), col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_territory, xlab="", ylab="Aves PC2 *", names=c("Weak", "Strong"),col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_territory, xlab="", ylab="Passerines PC2 *", names=c("Weak", "Strong"),col="tomato4")
mtext(text="Territoriality",side=1,line=0,outer=TRUE)
dev.off()
pdf(file="../data/Habitat.pdf",width=6,height=5)
par(mfrow=c(2,2),mar=c(2, 2, 2, 2),oma = c(2, 0.3, 0.2, 0.3))
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_AC$PC1~select_trait_AC$binary_habitat, xlab="",ylab="Aves PC1",  col="steelblue4")
par(mai=c(0.5,0.7,0.2,0),bty="l")
boxplot(select_trait_passer$PC1~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC1",col="tomato4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_AC$PC2~select_trait_AC$binary_habitat, xlab="", ylab="Aves PC2 *",col="steelblue4")
par(mai=c(0.7,0.7,0,0),bty="l")
boxplot(select_trait_passer$PC2~select_trait_passer$binary_habitat, xlab="", ylab="Passerines PC2 *", col="tomato4")
mtext(text="Habitat",side=1,line=0,outer=TRUE)
dev.off()
##additive models outline
#8 metric
passer1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset_passer,lambda= "ML")
summary(passer1)
#8 metric
passer2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(passer2)
#8 metric
Model2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model2)
#sc
Model3<-pgls(PC1~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset_SC,lambda= "ML")
summary(Model3)
##additive models outline
#8 metric
Model1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model1)
# b10k<-read_xlsx("../data/b10k.xlsx")
b10k<-read.csv("../data/b10kb.csv")
avgpasser <- read_xlsx("../data/avgpassertree.xlsx",1)
pPCAScores_passer<-read.csv("../data/pPCAScores_passer.csv")
pPCAScores_SC_passer<-read.csv("../data/pPCAScores_SC_passer.csv")
avgpasser$Family <- str_extract_all(avgpasser$HM4.Family, "^\\w+")
avgpasser$Family <- gsub(' [A-z ]*', '' , avgpasser$Family)
length(unique(avgpasser$Family))
length(unique(avgpasser$HM4.Order))
#delete species without acoustic data
b10k$scientific <- gsub(" ","_",b10k$scientific)
avgpasser$scientific <- gsub(" ","_",avgpasser$scientific)
b10k_pa<-b10k[match(avgpasser$scientific,b10k$scientific),]
# sum(is.na(b10k$scientific))
# check tip lable match b10k trait
# tree$tip.label[!(tree$tip.label %in% b10k$scientific)]
# select specific columns trait
b10k_pa <- as.data.frame(b10k_pa)
b10k_pa<- subset(b10k_pa, select = -c(b10k.m_mass, b10k.unsexed_mass, b10k.s_bond_stab, b10k.territory) )
# pick b10k trait with score
b10k_passer <- b10k_pa[match(pPCAScores_passer$X, b10k_pa$scientific),]
b10k_SC_passer <- b10k_pa[match(pPCAScores_SC_passer$X, b10k_pa$scientific),]
select_trait_passer<-data.frame(pPCAScores_passer,b10k_passer)
select_trait_SC_passer <-data.frame(pPCAScores_SC_passer,b10k_SC_passer)
#drop na in scientific name
select_trait_passer<-select_trait_passer %>% drop_na("scientific")
select_trait_SC_passer<-select_trait_SC_passer %>% drop_na("scientific")
dataset_passer <- comparative.data(data=select_trait_passer,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
dataset_SC_passer <- comparative.data(data=select_trait_SC_passer,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
##additive models outline
#8 metric
passer1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset_passer,lambda= "ML")
summary(passer1)
#8 metric
passer2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(passer2)
AIC(Model2)
# b10k<-read_xlsx("../data/b10k.xlsx")
b10k<-read.csv("../data/b10kb.csv")
avgsong <- read_xlsx("../data/avgsongtree.xlsx",1)
pPCAScores_song_2<-read.csv("../data/pPCAScores_8.csv")
pPCAScores_SC<-read.csv("../data/pPCAScores_SC.csv")
#delete species without acoustic data
b10k$scientific <- gsub(" ","_",b10k$scientific)
avgsong$scientific <- gsub(" ","_",avgsong$scientific)
b10k<-b10k[match(avgsong$scientific,b10k$scientific),]
# sum(is.na(b10k$scientific))
# check tip lable match b10k trait
# tree$tip.label[!(tree$tip.label %in% b10k$scientific)]
# select specific columns trait
b10k <- as.data.frame(b10k)
b10k<- subset(b10k, select = -c(b10k.m_mass, b10k.unsexed_mass, b10k.s_bond_stab, b10k.territory) )
# pick b10k trait with score
b10k_AC <- b10k[match(pPCAScores_song_2$X, b10k$scientific),]
b10k_SC <- b10k[match(pPCAScores_SC$X, b10k$scientific),]
select_trait <-data.frame(pPCAScores_song_2,b10k_AC)
# select_trait <- select_trait[match(pPCAScores_song_2$X, b10k_AC$scientific),]
select_trait_SC <-data.frame(pPCAScores_SC,b10k_SC)
#drop na in scientific name
select_trait_AC<-select_trait %>% drop_na("scientific")
select_trait_SC<-select_trait_SC %>% drop_na("scientific")
dataset <- comparative.data(data=select_trait_AC,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
dataset_SC <- comparative.data(data=select_trait_SC,phy=MyTree.1,names.col = "scientific",vcv = TRUE, warn.dropped = TRUE)
##additive models outline
#8 metric
Model1<-pgls(PC1~b10k.mass+binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model1)
#8 metric
Model2<-pgls(PC2~binary_migration+binary_s_bond_stab+binary_habitat+binary_unidirectional+b10k.mass+binary_territory+bill_PC1,dataset,lambda= "ML")
summary(Model2)
rm(list=ls())
setwd("~/Downloads/Birdsong/code/")
rawsong <- read_xlsx("../data/Raw_B10K_Song_Traits.xlsx",1)
rawsong[,26:95] <- lapply(rawsong[,26:95],as.numeric)
rawsong$Single.Note.Song.Pace <- as.numeric(rawsong$Single.Note.Song.Pace)
# rawsong[!apply(rawsong == "", 1, all),]
# summary(rawsong)
rawsong$Family <- str_extract_all(rawsong$HM4.Family, "^\\w+")
avgsong <- read_xlsx("../data/Main_B10K_Song_Average.xlsx",1)
avgsong$species <- str_replace(avgsong$species, "_", " ")
# rawsong <- rawsong %>% nest(-HM4.Latin.name)
avgsong <- avgsong[(avgsong$species %in% rawsong$HM4.Latin.name),]
rawsong <- rawsong[(rawsong$HM4.Latin.name %in% avgsong$species),]
birdtrait <- read_xlsx("../data/Main_B10K_Trait_datasheet.xlsx",skip = 1)
birdtrait$species <- str_replace(birdtrait$species, "_", " ")
#make note rate for single note song NA
for (i in 1:nrow(rawsong)){
if (rawsong$No_notes_in_call_bout.song [i] ==1 && rawsong$No_of_Note_Types[i] ==1){
rawsong$Note_Rate[i] <- NA
}
}
# mean for single note song pace
single_mean <- rawsong %>% group_by(HM4.Latin.name) %>% summarise(Mean = mean(Single.Note.Song.Pace, na.rm = TRUE))
rawsong <- rawsong %>% nest(-HM4.Latin.name)
# collecting mean of song traits
for (i in 1:nrow(avgsong)){
for (j in 1:nrow(rawsong)){
if (avgsong$species [i] == rawsong$HM4.Latin.name [j]){ # match species names
rawsub <- rawsong$data[[j]] #dubset for the species
if (length(which(rawsub$No_notes_in_call_bout.song== 1 && rawsub$No_of_Note_Types == 1 )) > 0 ){
avgsong$`Number of samples`[i] <- nrow(rawsub)
avgsong$Annotated[i] <- paste("yes")
avgsong$HM4.Order[i] <- unique(rawsub$HM4.Order)
avgsong$HM4.Family[i] <- unique(rawsub$HM4.Family)
avgsong$HM4.Common.name [i] <- unique(rawsub$HM4.Common.name)
avgsong$HM4.Latin.name [i] <- unique(rawsong$HM4.Latin.name [j])
# avgsong$HM4.Subspecies [i] <- unique(rawsub$HM4.Subspecies)
avgsong$No_notes_in_call_bout.song[i]<- mean(rawsub$No_notes_in_call_bout.song,na.rm = TRUE)
avgsong$No_of_Note_Types[i]<- mean(rawsub$No_of_Note_Types,na.rm = TRUE)
# avgsong$Single.Note.Song.Pace[i]<- mean(rawsub$Single.Note.Song.Pace,na.rm = TRUE)
avgsong[i,15:85] <- rawsub %>%
select(Note_Min_Freq_Average:Max.Power3) %>%
colMeans(na.rm = TRUE) %>%
unname()
avgsong$Single.Note.Song.Pace[i] <- single_mean$Mean[single_mean$HM4.Latin.name == avgsong$species [i]]
}
else {
avgsong$`Number of samples`[i] <- nrow(rawsub)
avgsong$Annotated[i] <- paste("yes")
avgsong$HM4.Order[i] <- unique(rawsub$HM4.Order)
avgsong$HM4.Family[i] <- unique(rawsub$HM4.Family)
avgsong$HM4.Common.name [i] <- unique(rawsub$HM4.Common.name)
avgsong$HM4.Latin.name [i] <- unique(rawsong$HM4.Latin.name [j])
# avgsong$HM4.Subspecies [i] <- unique(rawsub$HM4.Subspecies)
avgsong$No_notes_in_call_bout.song[i]<- mean(rawsub$No_notes_in_call_bout.song,na.rm = TRUE)
avgsong$No_of_Note_Types[i]<- mean(rawsub$No_of_Note_Types,na.rm = TRUE)
# avgsong$Single.Note.Song.Pace[i]<- mean(rawsub$Single.Note.Song.Pace,na.rm = TRUE)
avgsong[i,15:85] <- rawsub %>%
select(Note_Min_Freq_Average:Max.Power3) %>%
colMeans(na.rm = TRUE) %>%
unname()
avgsong[i,"Single.Note.Song.Pace"] <- NA
}
}}
}
write_xlsx(avgsong, "../data/avgsong.xlsx")
# make scientific name attached to average results
avgsong <- read_xlsx("../data/avgsong.xlsx",1)
species_missed <- read_xlsx("../data/missed_species.xlsx",1)
avgsong$scientific <-NA
for (i in 1:nrow(avgsong)){
for (j in 1:nrow(species_missed)){
if (avgsong$species [i] == species_missed$Avgsong [j]){
avgsong$scientific [i] <- species_missed$tree[j]
}
}
}
for (i in 1:nrow(avgsong)) {
if (is.na (avgsong$scientific[i]==TRUE)) {
avgsong$scientific[i]<-avgsong$species[i]
}
}
## make song pace of single note song as note rate
avgsong$Rate_Pace <- NA
for (i in 1:nrow(avgsong)){
if (avgsong$No_notes_in_call_bout.song [i] ==1 && avgsong$No_of_Note_Types[i] ==1){
avgsong$Rate_Pace[i] <- avgsong$Single.Note.Song.Pace[i]
}
else avgsong$Rate_Pace[i] <-avgsong$Note_Rate[i]
}
write_xlsx(avgsong, "../data/avgsongtree.xlsx")
